### 负载均衡的其他几个配置

**配置1**

**upstream backserver {** 

​       **server 127.0.0.1:9100;**

​       **#其它所有的非backup机器down的时候，才请求backup机器**

​       **server 127.0.0.1:9200 backup;** 

**}** 

**添加了backup的服务器是备份服务器，只有其他的服务器都宕机了，才会启动这个服务器**

**有什么作用呢？一般都是在项目上线的时候，需要更新代码，或者添加新功能。需要先把新代码添加到备份的服务器，然后停掉那一些服务器，这个时候用户访问的都是备份服务器的新内容，然后这个时候更新停掉的服务器的代码，然后再把停掉的服务器打开，用户访问的都是更新的新内容**



**在实际中，先更新备份服务器，然后关闭一部分服务器，更新代码，然后在关闭剩下的服务器的同时立刻打开**

**刚刚那些更新了代码的服务器，这个时候只有少量的服务进入到备份服务器。然后再更新剩下的那一些服务器即可**

**如果直接关闭所有服务器，备份服务器压力巨大，会宕机**





**配置2**

**upstream backserver {** 

​	**server 127.0.0.1:9100;**

​    **#down表示当前的server是down状态，不参与负载均衡**

​    **server 127.0.0.1:9200 down;** 

**}** 

**表示宕机了，即使服务器正常，nginx也认为是宕机的，nginx也不会使用这个服务器**