### RDB



**RDB全称Redis Database Backup file（Redis数据备份文件），也被叫做Redis数据快照。简单来说就是把内存中的所有数据都记录到磁盘中。当Redis实例故障重启后，从磁盘读取快照文件，恢复数据。**

**快照文件称为RDB文件，默认是保存在当前运行目录。**



**默认就开启了RDB   **

**Redis停机时会执行一次RDB**



**手动执行RDB，默认在redis停机的时候执行，默认保存在当前目录**

![rdb](E:\笔记整理\微服务技术\redis\图片\rdb.png)





**一些配置：**

![RDB配置](E:\笔记整理\微服务技术\redis\图片\RDB配置.png)



### RDB的执行



![RDB执行](E:\笔记整理\微服务技术\redis\图片\RDB执行.png)



**为什么要使用页表，因为linux的进程都无法操作内存，都需要一个页表来维护对应的映射关系**



**RDB方式bgsave的基本流程？**

**•fork主进程得到一个子进程，共享内存空间**

**•子进程读取内存数据并写入新的RDB文件**

**•用新RDB文件替换旧的RDB文件。**



**RDB会在什么时候执行？save 60 1000代表什么含义？**

**•默认是服务停止时。**

**•代表60秒内至少执行1000次修改则触发RDB**



**RDB的缺点？**

**•RDB执行间隔时间长，两次RDB之间写入数据有丢失的风险**

**•fork子进程、压缩、写出RDB文件都比较耗时**